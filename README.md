# Wodanio Business Operating System (BOS)

The Wodanio BOS is a CRM system built with NuxtJS v4 and Prisma ORM. It includes the following features:

- **Contact Management** with communication channels (phone, email and web, each with categories), addresses (with categories) and notes  
- Separation between **companies and persons**  
- Companies have an autogenerated **customer ID**  
- **OpenID Connect** login with automatic user creation  
- Simple **user-role management**  
- **Wodanio Payment Enforcement Service (PES)** integration (sync companies from bos to customers of pes)
- **listmonk** import via public subscription API
- **Pascom contact export** via CSV  
- **i18n** support for EN  
- **REST API** with Swagger/OpenAPI documentation

**Preview:**
![Preview](./public/preview.png)

## Deployment

Wodanio BOS requires an OpenID Provider, PostgreSQL (v17 recommended), and Redis.

The application runs on port `3000`.

### Quick Start

Clone GitHub repository:
```
git clone https://github.com/wodanio-group/bos.git wodaniobos
```

Navigate to the Wodanio BOS directory
```
cd ./wodaniobos
```

Start Docker Compose:
```
docker compose up -d
```

### Docker Image (Docker Hub)

| Image | Description |
| --- | --- |
| `wodanio/bos:latest` `wodanio/bos:main` | Latest stable build |
| `wodanio/bos:staging` | Latest development build (for testing only) |

### Environment Variables

| Variable | Default | Required | Description |
| --- | --- | --- | --- |
| `NUXT_SECRET` | | Yes | Secret for hashing |
| `NUXT_PUBLIC_SITE_URL` | `http://localhost:3000` | Yes | System URL |
| `NUXT_PUBLIC_SITE_TITLE` | `Wodanio Business Operation System` | | System application title |
| `NUXT_PUBLIC_LOGO_URL` | `https://de-zlg1.s3.wodanio.net/cdn/wodanio/logo/bos-logo.svg` | | System logo URL |
| `NUXT_DATABASE_URL` | | Yes | PostgreSQL connection string like `postgres://bos:bos@postgresql:5432/bos` |
| `NUXT_REDIS_URL` | `redis://localhost:6379/0` | Yes | Redis URL like `redis://localhost:6379/0` |
| `NUXT_OPEN_ID_ISSUER` | | Yes | OpenID issuer URL |
| `NUXT_OPEN_ID_CLIENT_ID` | | Yes | OpenID client ID |
| `NUXT_OPEN_ID_CLIENT_SECRET` | | Yes | OpenID client secret |
| `NUXT_OPEN_ID_ALLOW_AUTO_CREATE` | `true` | | Set to `false` to disable automatic user creation |
| `NUXT_PASCOM_CONNECTOR_USERNAME` | | | Pascom connector basic auth username (optional) |
| `NUXT_PASCOM_CONNECTOR_PASSWORD` | | | Pascom connector basic auth password (optional) |
| `NUXT_LISTMONK_URL` | | | Listmonk instance URL (optional) |
| `NUXT_LISTMONK_IMPORT_LIST_IDS` | | | Comma or semicolon-separated list of Listmonk list UUIDs for contact imports (optional) |
| `NUXT_PES_URL` | | | PES (Product Engineering System) API base URL (optional) |
| `NUXT_PES_API_TOKEN` | | | PES API authentication token (optional) |
| `NUXT_GOTENBERG_URL` | | | Gotenberg service URL for PDF generation (optional) |
| `NUXT_GOTENBERG_USERNAME` | | | Gotenberg basic auth username (optional) |
| `NUXT_GOTENBERG_PASSWORD` | | | Gotenberg basic auth password (optional) |

## API Documentation

The Wodanio BOS provides a comprehensive REST API with interactive OpenAPI/Swagger documentation.

### Accessing the API Documentation

Once the application is running, you can access the API documentation at:

**Swagger UI (Interactive Documentation):**
```
http://localhost:3000/api/docs
```

**OpenAPI Specification (YAML):**
```
http://localhost:3000/api/docs/yaml
```

Replace `localhost:3000` with your actual deployment URL (configured via `NUXT_PUBLIC_SITE_URL`).

### API Authentication

The API supports two authentication methods:

1. **Bearer Token Authentication:**
   - Create an API token via the UI (User menu â†’ API Tokens)
   - Include the token in the Authorization header: `Authorization: Bearer <your-token>`

2. **Cookie Authentication:**
   - Automatically used when logged in via the web interface
   - Session cookie is set after OpenID Connect login

## Pascom Connector

If you want to use the Pascom connector for contact imports, please set the environment variables `NUXT_PASCOM_CONNECTOR_USERNAME` and `NUXT_PASCOM_CONNECTOR_PASSWORD` and configure it as follows on your Pascom instance:

1. Log in to your Pascom instance as an administrator
2. Go to Settings > Connector and add a new "CSV Phonebook Sync"
3. Configure the connector as follows:
    - Name: choose any name
    - Type: `Fetch from url`
    - Encoding of the CSV File: `UTF-8`
    - Delimiter: `;`
    - Line Separator: `Windows (CRLF)`
    - Field Enclosure: `"`
4. Save the connector and then add the following information:
    - Automation: `Hourly` (recommended)
    - Mode: `Create and update records. Remove missing records from previous imports.` (recommended)
    - CSV file URL: `<URL for your Instanc>/api/pascom/connector/contact`
    - Username: `<NUXT_PASCOM_CONNECTOR_USERNAME>`
    - Password: `<NUXT_PASCOM_CONNECTOR_PASSWORD>`
5. Save the configuration
